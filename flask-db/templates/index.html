{% extends 'base.html' %}
{% block title %}Index{% endblock title %}

{% block content %}
    <h1>Index Page</h1>
    <ul>
        {% for person in people  %}
            <li>{{person}} <button onclick="deletePerson({{person.person_id}})">Delete</button> <a href="{{url_for('people_details', person_id=person.person_id)}}">Details</a></li>
        {% endfor %}
    </ul>

    <h3>Create a new Person:</h3><br>
    <form action="{{ url_for('index')}}" method="POST">
        <input type="text" name="name" placeholder="Name"><br>
        <input type="text" name="age" placeholder="Age"><br>
        <input type="text" name="job" placeholder="Job"><br>
        <input type="submit" value="Create">
    </form>

    <script type="text/javascript">
        function deletePerson(person_id){
            fetch("{{ url_for('delete_person', person_id=person_id)}}" + person_id, {
                method: 'DELETE'
            }).then(response => {
                if(response.ok){
                    window.location.reload();
                } else {
                    console.error('Failed to delete person with id: ', person_id)
                }
            }).catch(error => {
                console.error('Error during fetchin: ', error)
            })
        }
    </script>

{% endblock content %}

